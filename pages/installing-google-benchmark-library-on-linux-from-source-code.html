<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Installing Google 'Benchmark' library on Linux from source code</title>
</head>
<body>

    <h1 style="text-align: center;"><strong><span style="font-family: Tahoma,Geneva,sans-serif;">Installing Google 'Benchmark' library on Linux from source code</span></strong></h1>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><br></span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">In this tutorial we will look at how to compile and install Google's benchmark library on Linux system from source code.</span></p>
    <p><br></p>

    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><strong><span style="font-size: 18px;">Step 1 : Downloading source code</span></strong></span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">This can be done in two ways.</span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">1. Directly download the zip file containing source code of library from web URL:</span></p>
    <p style="margin-left: 20px;">
        <span style="font-family: Tahoma,Geneva,sans-serif;">&nbsp;
            <a href="https://github.com/google/benchmark/archive/master.zip" rel="noopener noreferrer" target="_blank">https://github.com/google/benchmark/archive/master.zip</a>&nbsp;
        </span>
    </p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">2. Clone the repository with your preferred Git/SVN client using repositories web URL:</span></p>
    <p style="margin-left: 20px;">
        <span style="font-family: Tahoma,Geneva,sans-serif;">&nbsp;
            <a href="https://github.com/google/benchmark.git" rel="noopener noreferrer" target="_blank">https://github.com/google/benchmark.git</a>&nbsp;
        </span>
    </p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">I prefer downloading zip, as currently I am not contributing in development of library and just want to try it out for my projects.</span></p>
    <p style="text-align: left; margin-left: 20px;">
        <img src="../images/google_benchmark/Google_Benchmark_GitHub_Page.png" alt="Google_Benchmark_GitHub_Page" class="inline">
    </p>
    <p><br></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><strong><span style="font-size: 18px;">Step 2 : Building / Compiling source code</span></strong></span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">After zip is downloaded, we have to extract it using unzip command.</span></p>
    <pre><span style="font-family: Tahoma,Geneva,sans-serif;"><span style="font-size: 14px; background-color: rgb(239, 239, 239);"><strong>unzip benchmark-master.zip</strong></span></span></pre>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">This will create benchmark-master directory containing actual source code of library. Goto benchmark-master directory using following command:</span></p>
    <pre><span style="font-family: Tahoma,Geneva,sans-serif;"><strong><span style="font-size: 14px; background-color: rgb(239, 239, 239);">cd benchmark-master</span></strong></span></pre>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">'benchmark' library uses CMake to manage its build process, so before starting build we first must generate <strong>Makefile</strong> using <strong>cmake</strong>. Following are the commands to generate a <strong>Makefile</strong>.</span></p>
    <pre><span style="font-family: Tahoma,Geneva,sans-serif;"><span style="font-size: 14px; background-color: rgb(239, 239, 239);"><strong>mkdir build
cd build
cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/opt/toolchain/google_benchmark_v1.1.0</strong></span></span></pre>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">Above commands create a build directory (you can give it any name you want) in benchmark-master directory which contain the source code. Goto build directory and execute <strong>cmake</strong> command with given options.</span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">In the last command "<strong>.."&nbsp;</strong>is the path to source code root folder (in this case the parent folder).</span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><strong>-DCMAKE_BUILD_TYPE</strong> is set to Release as our intention is to consume the library and not to debug it.</span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><strong>-DCMAKE_INSTALL_PREFIX</strong> option is custom install directory where our generated library will be installed. Without this option it will install into default system directories.</span></p>
    <p><br></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">I prefer using specific install directory so that I can use/try multiple versions of library without disturbing existing system setup. Also uninstalling is as simple as deleting the directory.</span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">After successful execution of above commands, <strong>Makefile</strong> is generated in current directory (i.e. inside build directory).</span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">Now use make command to start compiling source code and generate the library</span></p>
    <pre><span style="font-family: Tahoma,Geneva,sans-serif;"><span style="font-size: 14px; background-color: rgb(239, 239, 239);"><strong>make</strong></span></span></pre>
    <p><br></p>

    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><strong><span style="font-size: 18px;">Step 3 : Installing generated library</span></strong></span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">After compilation is successful, installing the library is very simple. Just give following command:</span></p>
    <pre><span style="font-family: Tahoma,Geneva,sans-serif;"><span style="font-size: 14px; background-color: rgb(239, 239, 239);"><strong>sudo make install</strong></span></span></pre>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">This will simply copy the generated library and required file to given installation location.</span></p>
    <p><br></p>

    <p><span style="font-family: Tahoma,Geneva,sans-serif;"><strong><span style="font-size: 18px;">Step 4 : Cleanup</span></strong></span></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">Finally, we have to delete the build folder as it is no longer needed. Fire following commands on terminal:</span></p>
    <pre><span style="font-family: Tahoma,Geneva,sans-serif;"><span style="font-size: 14px; background-color: rgb(239, 239, 239);"><strong>cd ..
rm -rf build</strong></span></span></pre>
    <p><br></p>
    <p><span style="font-family: Tahoma,Geneva,sans-serif;">We have completed installation part of library. In next tutorial we will look into how to use it to benchmark programs.</span></p>

</body>
</html>
